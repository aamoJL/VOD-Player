<?xml version="1.0" encoding="utf-8"?>
<Page
  x:Class="VODPlayer.MainPage"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:local="using:VODPlayer"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  mc:Ignorable="d"
  Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
  KeyboardAcceleratorPlacementMode="Hidden">

  <Page.KeyboardAccelerators>
    <KeyboardAccelerator Key="Space" Invoked="MediaPlayerStateKeyboardAccelerator_Invoked" />
  </Page.KeyboardAccelerators>
  
  <Page.Resources>
    <local:BoolToInvertedVisibilityConverter x:Key="BoolToInvertedVisibilityConverter" />
    <local:StringToBrushConverter x:Key="StringToBrushConverter" />
  </Page.Resources>
  
  <Grid Background="Transparent">
    <SplitView 
      IsPaneOpen="{x:Bind IsPaneOpen, Mode=OneWay}"
      CompactPaneLength="0"
      OpenPaneLength="340"
      DisplayMode="CompactInline"
      PanePlacement="Right">
      <SplitView.Pane>
        <Grid BorderThickness="1 0 0 0" BorderBrush="{ThemeResource CircleElevationBorderBrush}">
          <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>
          <Grid Grid.Row="0" Padding="10 0 10 0" BorderThickness="0 0 0 1" BorderBrush="{ThemeResource CircleElevationBorderBrush}">
            <TextBlock Text="STREAM CHAT" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold"/>
            <Button Command="{x:Bind PanelOpenCommand, Mode=OneTime}" CornerRadius="0">
              <FontIcon Glyph="&#xE89F;"/>
            </Button>
          </Grid>
          <ScrollViewer x:Name="CommentsScrollViewer" Grid.Row="1" VerticalScrollBarVisibility="Visible">
            <ItemsRepeater x:Name="CommentsItemsRepeater" ItemsSource="{x:Bind Comments, Mode=OneWay}">
              <ItemsRepeater.ItemTemplate>
                <DataTemplate x:DataType="local:Comment">
                  <local:CommentContainer
                    Commenter="{x:Bind Commenter, Mode=OneTime}"
                    Fragments="{x:Bind Fragments, Mode=OneTime}"
                    IsSent="{x:Bind IsSent, Mode=OneWay}"
                    CommenterForegroundBrush="{x:Bind Color, Converter={StaticResource StringToBrushConverter}, Mode=OneTime}"/>
                </DataTemplate>
              </ItemsRepeater.ItemTemplate>
            </ItemsRepeater>
          </ScrollViewer>
        </Grid>
      </SplitView.Pane>
      <Grid>
        <MediaPlayerElement x:Name="MediaPlayer" AreTransportControlsEnabled="True" AutoPlay="False" Tapped="MediaPlayer_Tapped" DoubleTapped="MediaPlayer_DoubleTapped">
          <MediaPlayerElement.TransportControls>
            <MediaTransportControls IsCompact="True"/>
          </MediaPlayerElement.TransportControls>
        </MediaPlayerElement>
        <Button 
          Command="{x:Bind PanelOpenCommand, Mode=OneTime}" 
          Visibility="{x:Bind IsPaneOpen, Converter={StaticResource BoolToInvertedVisibilityConverter}, Mode=OneWay}"  
          Opacity=".5" 
          Margin="5" 
          HorizontalAlignment="Right" 
          VerticalAlignment="Top" 
          CornerRadius="0">
          <FontIcon Glyph="&#xE8A0;"/>
        </Button>
      </Grid>
    </SplitView>
  </Grid>
</Page>
